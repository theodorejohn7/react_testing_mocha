{"version":3,"sources":["test/react-client-renderer.js"],"names":["isInBrowser","window","ReactClientRenderer","stage","createStage","renderedInstances","document","body","appendChild","vdom","dontConnectToDom","containerNode","Error","domNode","createElement","componentInstance","render","indexOf","push","forEach","destroyComponent","innerHTML","removeChild","unmountComponentAtNode","findDOMNode","parentElement","StageIdAttribute","StageId","setAttribute"],"mappings":";;;;;;;qjBAAA;;;QAGgBA,W,GAAAA,W;;AAFhB;;;;;;;;AAEO,SAASA,WAAT,GAAsB;AAAE,QAAQ,OAAOC,MAAP,KAAkB,WAA1B;AAAyC;;IAE3DC,mB,WAAAA,mB;;;;;;;0BAEJ;AACP,QAAKC,KAAL,GAAaC,aAAb;AACA,QAAKC,iBAAL,GAAyB,EAAzB;AACAC,YAASC,IAAT,CAAcC,WAAd,CAA0B,KAAKL,KAA/B;AACA;;;yBAEMM,I,EAA6C;AAAA,OAAvCC,gBAAuC,yDAAtB,KAAsB;AAAA,OAAfC,aAAe;;AACnD,OAAG,CAACX,aAAJ,EAAkB;AACjB,UAAM,IAAIY,KAAJ,CAAU,0EAAV,CAAN;AACA;;AAED,OAAI,CAAC,KAAKT,KAAV,EAAiB;AAChB,UAAM,IAAIS,KAAJ,CAAU,8EAAV,CAAN;AACA;;AAED,OAAIC,UAAUF,iBAAiBL,SAASQ,aAAT,CAAuB,KAAvB,CAA/B;AACA,OAAG,CAACJ,gBAAJ,EAAsB;AACrB,SAAKP,KAAL,CAAWK,WAAX,CAAuBK,OAAvB;AACA;AACD,OAAIE,oBAAoB,mBAASC,MAAT,CAAgBP,IAAhB,EAAsBI,OAAtB,CAAxB;AACA,OAAG,KAAKR,iBAAL,CAAuBY,OAAvB,CAA+BF,iBAA/B,MAAsD,CAAC,CAA1D,EAA4D;AAC3D,SAAKV,iBAAL,CAAuBa,IAAvB,CAA4BH,iBAA5B;AACA;AACD,UAAOA,iBAAP;AACA;;;4BAES;AACT,QAAKV,iBAAL,CAAuBc,OAAvB,CAA+BC,gBAA/B;AACA,QAAKf,iBAAL,GAAyB,EAAzB;AACA,OAAG,KAAKF,KAAR,EAAe;AACd,SAAKA,KAAL,CAAWkB,SAAX,GAAuB,EAAvB;AACA;AACD;;;4BAES;AACT,OAAI,CAAC,KAAKlB,KAAV,EAAiB;AAChB,UAAM,IAAIS,KAAJ,CAAU,4EAAV,CAAN;AACA;;AAEDN,YAASC,IAAT,CAAce,WAAd,CAA0B,KAAKnB,KAA/B;AACA;;;;;;AAGF,SAASiB,gBAAT,CAA0BL,iBAA1B,EAA4C;AAC3C,oBAASQ,sBAAT,CAAgC,mBAASC,WAAT,CAAqBT,iBAArB,EAAwCU,aAAxE;AACA;;AAED,IAAMC,mBAAmB,oBAAzB;AACA,IAAMC,UAAU,OAAhB;;AAEA,SAASvB,WAAT,GAAsB;AACrB,KAAMD,QAAQG,SAASQ,aAAT,CAAuB,KAAvB,CAAd;AACAX,OAAMyB,YAAN,CAAmB1B,oBAAoBwB,gBAAvC,EAAyDxB,oBAAoByB,OAA7E;AACA,QAAOxB,KAAP;AACA","file":"test/react-client-renderer.js","sourcesContent":["/// <reference path=\"../../typings/tsd.d.ts\"/>\r\nimport ReactDOM, {DOMComponent} from \"react-dom\";\r\n\r\nexport function isInBrowser(){ return (typeof window !== 'undefined'); }\r\n\r\nexport class ReactClientRenderer {\r\n\r\n\tmount() {\r\n\t\tthis.stage = createStage();\r\n\t\tthis.renderedInstances = [];\r\n\t\tdocument.body.appendChild(this.stage);\r\n\t}\r\n\r\n\trender(vdom, dontConnectToDom=false, containerNode) {\r\n\t\tif(!isInBrowser()){\r\n\t\t\tthrow new Error(\"trying to render component instance not in browser - use render.server()\");\r\n\t\t}\r\n\r\n\t\tif (!this.stage) {\r\n\t\t\tthrow new Error(\"trying to render in an unmounted renderer - did you forget to call .mount()?\");\r\n\t\t}\r\n\r\n\t\tvar domNode = containerNode || document.createElement(\"div\");\r\n\t\tif(!dontConnectToDom) {\r\n\t\t\tthis.stage.appendChild(domNode);\r\n\t\t}\r\n\t\tvar componentInstance = ReactDOM.render(vdom, domNode);\r\n\t\tif(this.renderedInstances.indexOf(componentInstance) === -1){\r\n\t\t\tthis.renderedInstances.push(componentInstance);\r\n\t\t}\r\n\t\treturn componentInstance;\r\n\t}\r\n\r\n\tcleanup() {\r\n\t\tthis.renderedInstances.forEach(destroyComponent);\r\n\t\tthis.renderedInstances = [];\r\n\t\tif(this.stage) {\r\n\t\t\tthis.stage.innerHTML = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tif (!this.stage) {\r\n\t\t\tthrow new Error(\"trying to destroy an unmounted renderer - did you forget to call .mount()?\");\r\n\t\t}\r\n\r\n\t\tdocument.body.removeChild(this.stage);\r\n\t}\r\n}\r\n\r\nfunction destroyComponent(componentInstance){\r\n\tReactDOM.unmountComponentAtNode(ReactDOM.findDOMNode(componentInstance).parentElement);\r\n}\r\n\r\nconst StageIdAttribute = 'data-automation-id';\r\nconst StageId = 'stage';\r\n\r\nfunction createStage(){\r\n\tconst stage = document.createElement(\"div\");\r\n\tstage.setAttribute(ReactClientRenderer.StageIdAttribute, ReactClientRenderer.StageId);\r\n\treturn stage;\r\n}\r\n"],"sourceRoot":"/source/"}